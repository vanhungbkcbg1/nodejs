<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<canvas id="canvas" width="1024" height="768" style="border:1px solid #000000;">
    Your browser does not support the HTML5 canvas tag.
</canvas>

<img src="" id="image">

<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script>
    var socket = io('http://localhost:456');
    socket.on('news', function (data) {
        console.log(data);
        socket.emit('my other event', { my: 'data' });
    });

    socket.on('file_receive', function (data) {
        if(data.error==1){
            console.log('error');
        }else
        {
            console.log(data.data);
        }
    });
    
    socket.on('image_receive', function (data) {

        console.log(data);
        if(data.error==1){
            console.log('error when receive image');
        }else
        {
            var ctx = document.getElementById('canvas').getContext('2d');
//            var image=document.getElementById('image');
//            image.sr
            var img = new Image();
            img.src = 'data:image/jpeg;base64,' + data.data;
            ctx.drawImage(img, 0, 0);


            var image=document.getElementById('image');
            image.src= 'data:image/jpeg;base64,' + data.data;
        }
    });

    socket.on('word_file_receive', function (data) {

            if(data.error==1){
                console.log('have an error when receive word file');
            }else{
                var contentType='application/msword';

                var dataView = new DataView(data.data);
                var blob = new Blob([dataView], { type: contentType });
//                var blob = new Blob(data.data, {type: 'application/msword'});
                var blobUrl = URL.createObjectURL(blob);
//
                window.location = blobUrl;
//                var dataUrl = 'data:' + contentType + ';base64,' + data.data;
//                var dataUrl = 'data:' + contentType + ';base64,' + data.data;

//                window.location = dataUrl;
                console.log(data.data);
            }
    });
</script>
</body>
</html>